# üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –§–∞–∑—ã 10: –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

**–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞:** 6 —Ñ–µ–≤—Ä–∞–ª—è 2026  
**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ  
**–ü—Ä–æ–≥—Ä–µ—Å—Å:** 15% (1.5/10 —á–∞—Å–æ–≤)

---

## üéØ –û–±—â–∞—è —Ü–µ–ª—å –§–∞–∑—ã 10

–ü–æ–ª–Ω–æ—Å—Ç—å—é –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Agent Runtime —Å legacy entities –Ω–∞ –Ω–æ–≤—É—é DDD-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:
- –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ Domain Services
- –û–±–Ω–æ–≤–∏—Ç—å Infrastructure Layer
- –û–±–Ω–æ–≤–∏—Ç—å Application Layer
- –£–¥–∞–ª–∏—Ç—å legacy –∫–æ–¥

---

## ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –ø–æ–¥—Ñ–∞–∑—ã

### –§–∞–∑–∞ 10.1.1: SessionManagementService ‚Üí ConversationManagementService

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–í—Ä–µ–º—è:** 1.5 —á–∞—Å–∞ (–ø–ª–∞–Ω: 2 —á–∞—Å–∞)  
**–û—Ç—á–µ—Ç:** [`doc/agent-runtime-phase-10-1-1-report.md`](agent-runtime-phase-10-1-1-report.md)

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `ConversationManagementService` (650 —Å—Ç—Ä–æ–∫)
- ‚úÖ –°–æ–∑–¥–∞–Ω `ConversationServiceAdapter` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- ‚úÖ –ù–∞–ø–∏—Å–∞–Ω–æ 17 —Ç–µ—Å—Ç–æ–≤ (100% –ø—Ä–æ—Ö–æ–¥—è—Ç)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `Conversation` entity –≤–º–µ—Å—Ç–æ `Session`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ConversationId` Value Object
- ‚úÖ –î–µ–ª–µ–≥–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É –≤ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

**–§–∞–π–ª—ã:**
1. `app/domain/session_context/services/conversation_management_service.py`
2. `app/domain/adapters/conversation_service_adapter.py`
3. `tests/unit/domain/session_context/services/test_conversation_management_service.py`

---

## üîÑ –¢–µ–∫—É—â–∞—è –ø–æ–¥—Ñ–∞–∑–∞

### –§–∞–∑–∞ 10.1.2: AgentOrchestrationService ‚Üí AgentCoordinationService

**–°—Ç–∞—Ç—É—Å:** üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ  
**–ü—Ä–æ–≥—Ä–µ—Å—Å:** 20%  
**–û—Ü–µ–Ω–∫–∞:** 2 —á–∞—Å–∞

**–ü–ª–∞–Ω:**
1. ‚è≥ –°–æ–∑–¥–∞—Ç—å `AgentCoordinationService` –≤ `agent_context`
2. ‚è≥ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Agent` entity –≤–º–µ—Å—Ç–æ `AgentContext`
3. ‚è≥ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `AgentCapabilities` Value Object
4. ‚è≥ –°–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
5. ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã

**–ò–∑—É—á–µ–Ω–æ:**
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `AgentOrchestrationService` (237 —Å—Ç—Ä–æ–∫)
- ‚úÖ –ù–æ–≤–∞—è `Agent` entity (358 —Å—Ç—Ä–æ–∫)
- ‚úÖ `AgentCapabilities` Value Object
- ‚úÖ `AgentRouterService` –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

---

## üìã –û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø–æ–¥—Ñ–∞–∑—ã

### –§–∞–∑–∞ 10.1.3: ExecutionEngine ‚Üí PlanExecutionService

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–∂–∏–¥–∞–µ—Ç  
**–û—Ü–µ–Ω–∫–∞:** 3 —á–∞—Å–∞

**–ü–ª–∞–Ω:**
- –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `ExecutionEngine` –Ω–∞ `ExecutionPlan` entity
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Value Objects –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤
- –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –≤ `PlanExecutionService`
- –û–±–Ω–æ–≤–∏—Ç—å `DependencyResolver` –∏ `SubtaskExecutor`

---

### –§–∞–∑–∞ 10.1.4: –û—Å—Ç–∞–ª—å–Ω—ã–µ Domain Services

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–∂–∏–¥–∞–µ—Ç  
**–û—Ü–µ–Ω–∫–∞:** 3 —á–∞—Å–∞

**–°–µ—Ä–≤–∏—Å—ã –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
1. `message_processor.py`
2. `agent_switcher.py`
3. `tool_result_handler.py`
4. `hitl_decision_handler.py`
5. `plan_approval_handler.py`
6. `subtask_executor.py`
7. `dependency_resolver.py`
8. `helpers/agent_switch_helper.py`

---

### –§–∞–∑–∞ 10.2: Infrastructure Layer

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–∂–∏–¥–∞–µ—Ç  
**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤

**–ó–∞–¥–∞—á–∏:**
- –û–±–Ω–æ–≤–∏—Ç—å Mappers (Session ‚Üí Conversation, AgentContext ‚Üí Agent, Plan ‚Üí ExecutionPlan)
- –û–±–Ω–æ–≤–∏—Ç—å Repository Implementations
- –û–±–Ω–æ–≤–∏—Ç—å Database Models

---

### –§–∞–∑–∞ 10.3: Application Layer

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–∂–∏–¥–∞–µ—Ç  
**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞

**–ó–∞–¥–∞—á–∏:**
- –û–±–Ω–æ–≤–∏—Ç—å Use Cases
- –û–±–Ω–æ–≤–∏—Ç—å Command Handlers
- –û–±–Ω–æ–≤–∏—Ç—å Query Handlers
- –û–±–Ω–æ–≤–∏—Ç—å Coordinators

---

### –§–∞–∑–∞ 10.4: –£–¥–∞–ª–µ–Ω–∏–µ Legacy Code

**–°—Ç–∞—Ç—É—Å:** ‚è≥ –û–∂–∏–¥–∞–µ—Ç  
**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞

**–ó–∞–¥–∞—á–∏:**
- –£–¥–∞–ª–∏—Ç—å legacy entities
- –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ repositories
- –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ services
- –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã
- –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã

| –ü–æ–¥—Ñ–∞–∑–∞ | –ü–ª–∞–Ω | –§–∞–∫—Ç | –°—Ç–∞—Ç—É—Å |
|---------|------|------|--------|
| 10.1.1 | 2—á | 1.5—á | ‚úÖ |
| 10.1.2 | 2—á | - | üîÑ |
| 10.1.3 | 3—á | - | ‚è≥ |
| 10.1.4 | 3—á | - | ‚è≥ |
| 10.2 | 5—á | - | ‚è≥ |
| 10.3 | 3.5—á | - | ‚è≥ |
| 10.4 | 2.5—á | - | ‚è≥ |
| **–ò—Ç–æ–≥–æ** | **21—á** | **1.5—á** | **7%** |

### –§–∞–π–ª—ã

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°–æ–∑–¥–∞–Ω–æ | –û–±–Ω–æ–≤–ª–µ–Ω–æ | –£–¥–∞–ª–µ–Ω–æ |
|-----------|---------|-----------|---------|
| Services | 1 | 1 | 0 |
| Adapters | 1 | 0 | 0 |
| Tests | 1 | 0 | 0 |
| Docs | 2 | 0 | 0 |
| **–ò—Ç–æ–≥–æ** | **5** | **1** | **0** |

### –¢–µ—Å—Ç—ã

| –ü–æ–¥—Ñ–∞–∑–∞ | –¢–µ—Å—Ç—ã | –ü—Ä–æ—Ö–æ–¥—è—Ç | –ü–æ–∫—Ä—ã—Ç–∏–µ |
|---------|-------|----------|----------|
| 10.1.1 | 17 | 17 (100%) | 100% |
| **–ò—Ç–æ–≥–æ** | **17** | **17** | **100%** |

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–≤–µ—Ä—à–∏—Ç—å –§–∞–∑—É 10.1.2:**
   - –°–æ–∑–¥–∞—Ç—å `AgentCoordinationService`
   - –°–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä
   - –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã
   - –°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç

2. **–ù–∞—á–∞—Ç—å –§–∞–∑—É 10.1.3:**
   - –ò–∑—É—á–∏—Ç—å `ExecutionEngine`
   - –°–æ–∑–¥–∞—Ç—å `PlanExecutionService`
   - –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É

3. **–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:**
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–µ—Ä–≤–∏—Å—ã
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ

---

## üìù –ó–∞–º–µ—Ç–∫–∏

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ

1. **–ê–¥–∞–ø—Ç–µ—Ä—ã** - –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é –±–µ–∑ breaking changes
2. **–¢–µ—Å—Ç—ã** - –¥–∞—é—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω–∏–º–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. **–ü–æ—ç—Ç–∞–ø–Ω–æ—Å—Ç—å** - —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫–∏

### –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:** Legacy –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ 24+ –º–µ—Å—Ç–∞—Ö  
**–†–µ—à–µ–Ω–∏–µ:** –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ–ª—å—à–æ–π –æ–±—ä–µ–º —Ä–∞–±–æ—Ç—ã  
**–†–µ—à–µ–Ω–∏–µ:** –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏–µ –ø–æ–¥—Ñ–∞–∑—ã

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∏—Å–∫ breaking changes  
**–†–µ—à–µ–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ API —á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä—ã

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [–ü–ª–∞–Ω –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏](AGENT_RUNTIME_FULL_MIGRATION_PLAN.md)
- [–û—Ç—á–µ—Ç –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏](agent-runtime-refactoring-complete-report.md)
- [–û—Ç—á–µ—Ç –§–∞–∑—ã 10.1.1](agent-runtime-phase-10-1-1-report.md)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 6 —Ñ–µ–≤—Ä–∞–ª—è 2026, 09:13 UTC+3
