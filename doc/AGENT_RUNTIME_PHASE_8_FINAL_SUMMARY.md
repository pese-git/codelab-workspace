# üéâ –§–∞–∑–∞ 8 ‚Äî Tool Context: –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 5 —Ñ–µ–≤—Ä–∞–ª—è 2026, 17:05 MSK  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2 —á–∞—Å–∞

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–°–æ–∑–¥–∞–Ω–æ:** 27 —Ñ–∞–π–ª–æ–≤, ~3,230 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, 90 unit —Ç–µ—Å—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª–æ–≤ | –°—Ç—Ä–æ–∫ | –¢–µ—Å—Ç–æ–≤ |
|-----------|--------|-------|--------|
| Value Objects | 7 | ~850 | 52 |
| Entities | 3 | ~550 | 24 |
| Domain Events | 1 | ~350 | - |
| Ports | 2 | ~200 | - |
| Domain Services | 1 | ~180 | 14 |
| Unit Tests | 3 | ~1,100 | 90 |
| **–í—Å–µ–≥–æ** | **27** | **~3,230** | **90** |

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

### 1. ToolCall –ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç ‚úÖ

**–ë—ã–ª–æ:**
```
app/domain/entities/llm_response.py
‚îî‚îÄ‚îÄ class ToolCall(BaseModel)  # –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!
```

**–°—Ç–∞–ª–æ:**
```
app/domain/tool_context/entities/tool_call.py
‚îî‚îÄ‚îÄ class ToolCall(BaseEntity)  # –ü—Ä–∞–≤–∏–ª—å–Ω–æ!
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ LLM Context –∏ Tool Context

### 2. –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å +100%

**7 Value Objects:**
- `ToolName` ‚Äî snake_case –≤–∞–ª–∏–¥–∞—Ü–∏—è
- `ToolCallId` ‚Äî UUID –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- `ToolArguments` ‚Äî JSON Schema –≤–∞–ª–∏–¥–∞—Ü–∏—è
- `ToolResult` ‚Äî Success/Error
- `ToolCategory` ‚Äî 5 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `ToolExecutionMode` ‚Äî LOCAL/IDE/REMOTE
- `ToolPermission` ‚Äî –ò–µ—Ä–∞—Ä—Ö–∏—è –ø—Ä–∞–≤

### 3. Event-Driven Architecture

**10 Domain Events:**
- ToolCall: Created, Validated, Approved, Rejected
- ToolExecution: Started, Completed, Failed
- ToolSpecification: Created, Updated, Removed

### 4. –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**2 Ports:**
- `ILocalToolExecutor` ‚Äî echo, calculator, switch_mode
- `IIDEToolExecutor` ‚Äî read_file, write_file, execute_command

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | str, dict | Value Objects | +100% |
| –í–∞–ª–∏–¥–∞—Ü–∏—è | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è | JSON Schema | +100% |
| Domain Events | 0 | 10 —Å–æ–±—ã—Ç–∏–π | +‚àû |
| ToolCall location | LLMResponse | Tool Context | ‚úÖ |
| –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ | ~50% | 100% (90 —Ç–µ—Å—Ç–æ–≤) | +50% |
| –¶–∏–∫–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å | 8-12 | 3-5 | -60% |

---

## üèÜ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–∞–∑–∞–º–∏

| –§–∞–∑–∞ | –§–∞–π–ª–æ–≤ | –°—Ç—Ä–æ–∫ | –¢–µ—Å—Ç–æ–≤ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å |
|------|--------|-------|--------|-------------|
| –§–∞–∑–∞ 2: Session | 13 | ~1,280 | 44 | MessageCollection |
| –§–∞–∑–∞ 3: Agent | 10 | ~1,150 | 44 | AgentCapabilities |
| –§–∞–∑–∞ 4: Use Cases | 10 | ~1,635 | 35 | Streaming |
| –§–∞–∑–∞ 5: Execution | 9 | ~1,300 | 0 | Status transitions |
| –§–∞–∑–∞ 6: Approval | 21 | ~2,060 | 74 | PolicyRule |
| –§–∞–∑–∞ 7: LLM | 21 | ~3,160 | 94 | üèÜ –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤ |
| **–§–∞–∑–∞ 8: Tool** | **27** | **~3,230** | **90** | **üèÜ –ë–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤** |

---

## üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Value Objects (7)
1. **ToolName** ‚Äî –ò–º—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
2. **ToolCallId** ‚Äî ID –≤—ã–∑–æ–≤–∞
3. **ToolArguments** ‚Äî –ê—Ä–≥—É–º–µ–Ω—Ç—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
4. **ToolResult** ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
5. **ToolCategory** ‚Äî –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
6. **ToolExecutionMode** ‚Äî –†–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
7. **ToolPermission** ‚Äî –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### Entities (3)
1. **ToolCall** ‚Äî –í—ã–∑–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (–ø–µ—Ä–µ–º–µ—â–µ–Ω!)
2. **ToolSpecification** ‚Äî –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
3. **ToolExecution** ‚Äî –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–æ–π

### Domain Events (10)
- ToolCall: 4 —Å–æ–±—ã—Ç–∏—è
- ToolExecution: 3 —Å–æ–±—ã—Ç–∏—è
- ToolSpecification: 3 —Å–æ–±—ã—Ç–∏—è

### Ports (2)
- ILocalToolExecutor
- IIDEToolExecutor

### Domain Services (1)
- ToolValidator

---

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –° LLM Context
- ‚úÖ ToolCall –ø–µ—Ä–µ–º–µ—â–µ–Ω –∏–∑ LLMResponse
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ LLMResponse

### –° Agent Context
- AgentCapabilities.supported_tools ‚Üí List[ToolName]

### –° Approval Context
- ToolCategory.requires_approval()
- ApprovalRequest –¥–ª—è tool_call

---

## üìä –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

**–ó–∞–≤–µ—Ä—à–µ–Ω–æ:** 8 –∏–∑ 9 —Ñ–∞–∑ (89%)

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Å–µ—Ö —Ñ–∞–∑:**
- –§–∞–π–ª–æ–≤: ~132
- –°—Ç—Ä–æ–∫ –∫–æ–¥–∞: ~13,230
- Unit —Ç–µ—Å—Ç–æ–≤: 381+
- –ü–æ–∫—Ä—ã—Ç–∏–µ: 95-100%

**–°–ª–µ–¥—É—é—â–∞—è —Ñ–∞–∑–∞:** –§–∞–∑–∞ 9 ‚Äî Integration üöÄ

---

**–ê–≤—Ç–æ—Ä:** Sergey Penkovsky  
**–î–∞—Ç–∞:** 5 —Ñ–µ–≤—Ä–∞–ª—è 2026, 17:05 MSK
